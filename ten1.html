<!DOCTYPE html>
<html>
  <head>
    <title>Finally Live</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="referrer" content="no-referrer" />
    <link href="fav.png" rel="shortcut icon" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.12.5/shaka-player.ui.min.js"
      crossorigin="anonymous"
      defer
    ></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.12.5/controls.min.css"
    />

    <style>
      :root {
        --mint: #00d8ff;
        --muted: #cbd5e1;
        --glass-border: rgba(255, 255, 255, 0.06);
        --radius: 12px;
      }

      html,
      body {
        height: 100%;
        margin: 0;
        padding: 0;
        background: #0b0b10;
        color: #fff;
        font-family: system-ui, -apple-system, "Segoe UI", Roboto,
          "Helvetica Neue", Arial;
        overflow: hidden;
      }

      .video-container {
        align-items: center;
        border-radius: 12px;
        box-shadow: rgba(0, 0, 0, 0.4) 0 2px 4px,
          rgba(0, 0, 0, 0.3) 0 7px 13px -3px,
          rgba(0, 0, 0, 0.2) 0 -3px 0 inset;
        display: flex;
        height: 100%;
        justify-content: center;
        position: relative;
        width: 100%;
        overflow: hidden;
      }

      #video {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: contain;
        border-radius: 12px;
      }

      img {
        position: absolute;
        top: 10px;
        left: 15px;
        max-width: 115px;
        max-height: 25px;
        -webkit-animation: 5s ease-in-out infinite both blink3;
        animation: 5s ease-in-out infinite both blink3;
      }

      @-webkit-keyframes blink3 {
        0%,
        100%,
        50% {
          opacity: 1;
        }
        25%,
        75% {
          opacity: 0;
        }
      }
      @keyframes blink3 {
        0%,
        100%,
        50% {
          opacity: 1;
        }
        25%,
        75% {
          opacity: 0;
        }
      }

      /* Spinner */
      #loadingSpinner {
        display: none;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 110px;
        height: 110px;
        border-radius: 50%;
        border: 3px solid transparent;
        border-top: 5px solid #fff000;
        border-right: 5px solid #fff000;
        animation: animateSpinner 2s linear infinite;
        z-index: 10;
      }

      @keyframes animateSpinner {
        0% {
          transform: translate(-50%, -50%) rotate(0deg);
        }
        100% {
          transform: translate(-50%, -50%) rotate(360deg);
        }
      }

      @media (min-width: 1024px) {
        .video-container {
          height: 94vh;
        }
        #video {
          object-fit: fill;
        }
      }

      @media (max-width: 1023px) {
        .video-container {
          padding-bottom: 56.25%;
        }
        #video {
          object-fit: contain;
        }
      }
    </style>
  </head>
  <body>
    <div class="video-container">
      <video
        id="video"
        poster=""
        autoplay
        controls
        preload="auto"
        class="shaka-video"
      ></video>
      <div id="loadingSpinner"></div>
      <img src="logo.png" alt="Logo" />
    </div>

    <script>
      async function init() {
        const ui = document.getElementById("video").ui;
        const controls = ui.getControls();
        const player = controls.getPlayer();

        // ⚡ Optimize streaming config
		player.configure({
          drm: {
            clearKeys: {
              "5deb190b1dac28e46c0bdada7668b7de":
                "ddd2b372702e42b0d2708a70b91dec8d",
            },
          },
          streaming: {
            bufferingGoal: 5, // Faster startup
            rebufferingGoal: 2, // Quicker resume
            startAtSegmentBoundary: true,
            lowLatencyMode: true,
          },
        });

        // Optional auth header
        const token = "";
        if (token) {
          player
            .getNetworkingEngine()
            .registerRequestFilter((type, request) => {
              if (
                type === shaka.net.NetworkingEngine.RequestType.MANIFEST ||
                type === shaka.net.NetworkingEngine.RequestType.SEGMENT
              ) {
                request.headers.Authorization = token;
              }
            });
        }

        ui.configure({
          controlPanelElements: [
            "play_pause",
            "mute",
            "volume",
            "spacer",
            "time_and_duration",
            "picture_in_picture",
            "fullscreen",
            "overflow_menu",
          ],
          volumeBarColors: {
            base: "rgba(255,0,150,0.7)",
            level: "rgba(0,204,255,0.7)",
          },
          seekBarColors: {
            base: "rgba(0,204,255,0.7)",
            buffered: "rgba(255,0,150,0.7)",
            played: "rgba(0,204,255,0.7)",
          },
        });

        window.player = player;
        window.ui = ui;

        player.addEventListener("error", onPlayerErrorEvent);
        controls.addEventListener("error", onUIErrorEvent);

        const spinner = document.getElementById("loadingSpinner");
        player.addEventListener("buffering", (e) => {
          spinner.style.display = e.buffering ? "block" : "none";
        });

        try {
          await player.load(
            "https://ottb.live.cf.ww.aiv-cdn.net/lhr-nitro/live/dash/enc/bsaaetko8v/out/v1/bd3b0c314fff4bb1ab4693358f3cd2d3/cenc.mpd"
          );
          console.log("Stream loaded successfully!");
        } catch (err) {
          onPlayerError(err);
        }
      }

      function onPlayerErrorEvent(e) {
        onPlayerError(e.detail);
      }
      function onPlayerError(err) {
        console.error("Shaka Player Error:", err);
      }
      function onUIErrorEvent(e) {
        onPlayerError(e.detail);
      }
      function initFailed(e) {
        console.error("Shaka UI Load Failed:", e);
      }

      document.addEventListener("shaka-ui-loaded", init);
      document.addEventListener("shaka-ui-load-failed", initFailed);
    </script>
  </body>
</html>
